## Что такое PowerShell?

**PowerShell** - это интерактивная командная оболочка и сценарный язык, разработанный корпорацией Microsoft, предназначенный для автоматизации административных задач и управления операционной системой Windows, а также некоторыми другими продуктами Microsoft.  

PowerShell представляет собой мощное средство для выполнения разнообразных задач, включая управление файлами и папками, настройку служб, работу с реестром, администрирование активной директории, управление сетевыми настройками и многое другое.  

### Возможности PowerShell?
1. Командлеты и модули: PowerShell предоставляет широкий набор встроенных командлетов для выполнения разнообразных задач. Кроме того, вы можете создавать собственные командлеты и модули, расширяя функциональность PowerShell под свои нужды.  

2. Скриптинг: Вы можете создавать скрипты PowerShell, которые автоматизируют повторяющиеся задачи. Скрипты позволяют объединять команды в последовательность и выполнять сложные операции.  

3. Управление файлами и папками: PowerShell позволяет создавать, копировать, перемещать и удалять файлы и папки, а также выполнять операции с файловой системой.  

4. Управление службами и процессами: Вы можете управлять службами Windows, процессами и задачами на уровне операционной системы с помощью PowerShell.  

5. Управление реестром: PowerShell позволяет читать и записывать данные в реестр Windows, что полезно для настройки системы.  

6. Управление сетью: PowerShell предоставляет средства для работы с сетевыми настройками, настройки сетевых адаптеров и выполнения сетевых действий. 

7. Управление активной директорией: Администраторы могут использовать PowerShell для управления активной директорией, включая создание, удаление и настройку объектов, таких как пользователи, группы и компьютеры. 

8. Управление виртуальными машинами: PowerShell поддерживает взаимодействие с гипервизорами, такими как Hyper-V, что позволяет автоматизировать управление виртуальными машинами.  

9. Управление облаками и Azure: PowerShell интегрирован с платформой Microsoft Azure, что позволяет администраторам облегчить управление ресурсами в облаке.  

10. Управление базами данных: PowerShell может использоваться для управления базами данных, включая Microsoft SQL Server.  

11. Интероперабельность: PowerShell поддерживает взаимодействие с другими языками и технологиями через командлеты и скрипты, что делает его полезным инструментом в гибридных средах.  

12. Автоматизация конфигурации: PowerShell DSC (Desired State Configuration) позволяет определять и управлять состоянием конфигурации системы, обеспечивая автоматизацию процесса развертывания и обслуживания.  

13. Событий и мониторинг: PowerShell может использоваться для мониторинга событий и сбора данных для анализа и отчетов.  

14. Графический интерфейс: PowerShell можно использовать для создания графических интерфейсов (например, с использованием WPF), что позволяет создавать пользовательские приложения и инструменты.  

15. Безопасность: PowerShell обеспечивает средства управления безопасностью, включая возможности управления правами доступа и шифрование данных.  


## Отличия PowerShell от CMD
1. **Язык и сценарии:**  
- cmd.exe: Это старая командная оболочка, которая предоставляет ограниченный набор команд и не имеет мощного сценарного языка. Команды в cmd.exe обычно ограничиваются базовыми командами DOS.  

- PowerShell: Это современная командная оболочка и сценарный язык, который предоставляет богатый набор командлетов (cmdlets) и возможности сценарного программирования. PowerShell использует синтаксис, близкий к языкам программирования, с множеством операторов, структур данных и возможностью создания сложных сценариев.  

2. **Автоматизация:**  
- cmd.exe: Ограничен в возможностях автоматизации и часто требует использования утилит, скриптов на других языках (как, например, batch-файлы), и в целом менее мощен в области автоматизации задач.  

- PowerShell: Разработан с учетом автоматизации. Он позволяет легко создавать скрипты для автоматизации различных задач, включая управление файлами, настройку серверов, управление службами, работу с реестром и многие другие операции.  

3. **Командлеты vs. команды:**  
- cmd.exe: Использует команды, такие как dir, cd, ping, ipconfig, которые часто ограничены своим функционалом и синтаксисом.

- PowerShell: Использует командлеты (cmdlets), которые представляют собой мощные и однородные команды, чаще всего имеющие согласованный формат "глагол-существительное". Каждый cmdlet выполняет конкретную задачу и легко комбинируется для создания более сложных сценариев.

4. **Интероперабельность:**  
- cmd.exe: Основная цель - выполнение команд DOS и стандартных системных команд.  

- PowerShell: Легко взаимодействует с другими технологиями и языками, что делает его более подходящим для работы с широким спектром приложений и сервисов.  

5. **Уровень безопасности:**  
- PowerShell: Обладает более строгими мерами безопасности и возможностью управления политиками выполнения сценариев, что делает его более подходящим для сред с повышенными требованиями к безопасности. 

### Просмотр журнала событий Windows PowerShell

Журнал событий Windows PowerShell можно просмотреть в Просмотр событий или с помощью Get-EventLog командлетов и Get-WmiObject. Чтобы просмотреть содержимое журнала Windows PowerShell, введите следующее:

```Get-EventLog -LogName "Windows PowerShell"```

Для просмотра и фильтрации событий, сохраняемых в журналах Windows, применяется командлет Get-EventLog. Для этого командлета можно применять 14 параметров: After, AsBaseObject, AsString, Before, ComputerName, EntryType, Index, InstanceID, List, LogName, Message, Newest, Source и UserName. Все эти параметры предназначены для управления форматом вывода и уровнем детализации. С их помощью можно применять гибкую фильтрацию для включения или исключения событий из набора результатов. Также можно автоматизировать рутинные операции, сохранив скрипт в файл с расширением *.ps1.

Для того чтобы просмотреть события определенного журнала, в командной оболочке PowerShell введите командлет Get-EventLog, укажите название журнала, который вы хотите просмотреть и, по необходимости, задайте параметры для отображения тех или иных свойств фильтрации или столбцов для отображения событий.

Чтобы изучить события и их свойства, используйте Sort-Object командлет, Group-Object командлет и командлеты, содержащие Format команду (Format командлеты). Для получения дополнительных сведений введите Get-Help  -List и Get-Help Get-WmiObject.


### Как узнать версию?

Узнать версию установленной на компьютере командной оболочки можно с помощью свойства PSVersion встроенной переменной $PSVersionTable. Также можно воспользоваться командлетом: Get-Variable -Name PSVersionTable –ValueOnly. Также с помощью командлета Get-Host. На самом деле вариантов множество, но для их применения нужно изучить язык программирования PowerShell.